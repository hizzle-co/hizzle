(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var n=e.n(t);const s=window.wp.element,i=window.wp.components,a=window.React,r=window.hizzlewp.interface,o=window.wp.data,c=window.wp.notices,l=window.ReactJSXRuntime;function d(){const{notices:e}=(0,o.useSelect)((e=>({notices:e(c.store).getNotices()})),[]),{removeNotice:t}=(0,o.useDispatch)(c.store),n=e.filter((({isDismissible:e,type:t})=>e&&"default"===t)),s=e.filter((({isDismissible:e,type:t})=>!e&&"default"===t));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.NoticeList,{notices:s,className:"components-editor-notices__pinned"}),(0,l.jsx)(i.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:t})]})}function p(){const e=(0,o.useSelect)((e=>e(c.store).getNotices()),[]),{removeNotice:t}=(0,o.useDispatch)(c.store),n=e.filter((({type:e})=>"snackbar"===e)).slice(-3);return(0,l.jsx)(i.SnackbarList,{notices:n,className:"components-editor-notices__snackbar",onRemove:t})}const u=window.hizzlewp.components,h=window.hizzlewp.history,m=window.wp.compose,x=window.wp.apiFetch;var g=e.n(x);const _=window.wp.i18n,j=(0,a.createContext)({option_name:"",saved:{},settings:[],isSaving:!1,setAttributes:()=>{},save:()=>{}}),w=()=>(0,a.useContext)(j),b=({settings:e,option_name:t,saved:n,children:s})=>{const[i,r]=(0,a.useState)(n),[d,p]=(0,a.useState)(!1),u=(0,a.useRef)(!1),{createSuccessNotice:h,createErrorNotice:m}=(0,o.useDispatch)(c.store),x=(0,a.useMemo)((()=>Object.keys(e).map((t=>{const n=e[t],s=Object.keys(n.sub_sections)[0],i=[];return Object.keys(n.sub_sections).map((e=>{const s=n.sub_sections[e];i.push({name:e,title:s.label,settings:s.settings,path:`/${t}/${e}`})})),{name:t,title:n.label,path:`/${t}/${s}`,sections:i}}))),[e]);(0,a.useEffect)((()=>{const e=e=>{if(u.current)return e.returnValue=(0,_.__)("You have unsaved changes. If you proceed, they will be lost."),e.returnValue};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[u.current]);const w=(0,a.useCallback)((()=>{p(!0),u.current=!1,g()({path:"/wp/v2/settings",method:"POST",data:{[t]:{...i}}}).then((e=>(h((0,_.__)("Settings saved."),{type:"snackbar"}),"object"==typeof e&&null!==e&&t in e&&r(e[t]),e))).catch((e=>{e.message?m(e.message):m((0,_.__)("An error occurred while saving."))})).finally((()=>{p(!1)}))}),[i,r,p,h,m,t]),b=(0,a.useCallback)((e=>{u.current=!0,r({...i,...e})}),[i,r]),v=(0,a.useMemo)((()=>({option_name:t,saved:i,settings:x,isSaving:d,save:w,setAttributes:b})),[t,i,x,d,w,b]),f=(0,a.useMemo)((()=>({pointerEvents:d?"none":"auto",cursor:d?"wait":"auto"})),[d]);return(0,l.jsx)(j.Provider,{value:v,children:(0,l.jsx)("div",{style:f,children:s})})};function v(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=v(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}const f=function(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=v(e))&&(s&&(s+=" "),s+=t);return s};function y({id:e,heading:t,description:n,help_url:s,badges:r,className:o,settings:c,cardProps:d}){const[p,h]=(0,a.useState)(!1),{saved:m}=w();let x=null;r.forEach((e=>{Array.isArray(e.conditions)&&!(0,u.checkConditions)(e.conditions,m)||(x=(0,l.jsx)(i.__experimentalText,{...e.props,children:e.text}))}));const g=()=>s?(0,l.jsx)(i.Button,{href:s,target:"_blank",icon:"info",label:"Learn more",showTooltip:!0}):n?(0,l.jsx)(i.Icon,{icon:"info",style:{color:"#454545"}}):null;return(0,l.jsxs)(i.Card,{id:e,size:"small",className:f(o,"noptin-no-shadow"),...d||{},children:[(0,l.jsx)(i.CardHeader,{style:{padding:0},children:(0,l.jsxs)(i.Flex,{as:i.Button,onClick:()=>h(!p),style:{paddingLeft:16,paddingRight:16,height:48},label:n,showTooltip:!0,children:[(0,l.jsxs)(i.__experimentalHStack,{as:i.FlexBlock,children:[(0,l.jsx)(i.__experimentalText,{as:"h3",weight:600,children:t}),(0,l.jsx)(g,{})]}),(0,l.jsx)(i.FlexItem,{children:(0,l.jsxs)(i.__experimentalHStack,{children:[x,(0,l.jsx)(i.Icon,{icon:p?"arrow-up-alt2":"arrow-down-alt2"})]})})]})}),p&&(0,l.jsx)(i.CardBody,{children:(0,l.jsxs)(i.__experimentalVStack,{spacing:6,children:[(0,l.jsx)(z,{settings:c}),s&&(0,l.jsx)(i.__experimentalHStack,{alignment:"flex-end",justify:"flex-end",children:(0,l.jsxs)(i.Button,{href:s,target:"_blank",label:"Need help?",variant:"secondary",showTooltip:!0,children:[(0,l.jsx)(i.__experimentalText,{children:"View integration guide"}),(0,l.jsx)(i.Icon,{icon:"external"})]})})]})})]})}function S({id:e,label:t,className:n,settings:s,conditions:a,cardProps:r}){const{saved:o}=w();return Array.isArray(a)&&!(0,u.checkConditions)(a,o)?null:(0,l.jsxs)(i.Card,{id:e,isRounded:!1,className:f("hizzlewp-settings__group",n),...r||{},children:[(0,l.jsx)(i.CardHeader,{children:(0,l.jsx)(i.__experimentalHeading,{level:4,size:16,children:t})}),(0,l.jsx)(i.CardBody,{children:(0,l.jsx)(z,{settings:s})})]})}const N=()=>{const e=(0,m.useViewportMatch)("small","<"),{settings:t}=w(),{params:n,location:s,goTo:r}=(0,i.__experimentalUseNavigator)(),o=(0,h.usePath)();(0,a.useEffect)((()=>{o!==s.path&&r(o)}),[o,s.path]);const{tab:c,section:d}=(0,a.useMemo)((()=>{if(!n.tab)return{tab:t[0].name,section:t[0].sections[0].name};const e=t.find((e=>e.name===n.tab));if(!e)return{tab:t[0].name,section:t[0].sections[0].name};if(!n.section)return{tab:e.name,section:e.sections[0].name};const s=e.sections.find((e=>e.name===n.section));return s?{tab:e.name,section:s.name}:{tab:e.name,section:e.sections[0].name}}),[n.tab,n.section,t]),p=(0,a.useMemo)((()=>t.find((e=>e.name===c))),[c,t]);return(0,l.jsx)("div",{children:(0,l.jsxs)(i.__experimentalVStack,{spacing:4,"data-current-path":s.path,style:{padding:20},children:[1<t.length&&(0,l.jsx)(i.__experimentalSurface,{className:"hizzlewp-settings__tabs",orientation:e?"vertical":"horizontal",onNavigate:e=>(0,h.updatePath)(t[e].path),as:i.NavigableMenu,borderBottom:!0,borderTop:!0,borderLeft:!0,borderRight:!0,children:t.map((e=>(0,l.jsx)(i.Button,{onClick:()=>(0,h.updatePath)(e.path),className:"components-tab-panel__tabs-item "+(c===e.name?"is-active":""),"aria-selected":c===e.name,children:e.title},e.path)))}),p&&(0,l.jsx)(k,{...p,currentTab:c,currentSection:d})]},o)})},k=({name:e,sections:t,currentTab:n,currentSection:s})=>{const{location:r}=(0,i.__experimentalUseNavigator)(),o=(0,a.useMemo)((()=>t.find((e=>e.name===s))),[n,s]);return(0,l.jsxs)(u.ErrorBoundary,{children:[1<t.length&&(0,l.jsx)(i.NavigableMenu,{className:`hizzlewp-settings__sections-menu hizzlewp-settings__sections-menu--${e}`,orientation:"horizontal",onNavigate:e=>(0,h.updatePath)(t[e].path),children:t.map((e=>(0,l.jsx)(i.Button,{onClick:()=>(0,h.updatePath)(e.path),variant:"tertiary",isPressed:r.path===e.path,children:e.title},e.path)))}),o&&(0,l.jsx)(z,{settings:o.settings})]})},z=({settings:e})=>{const{isSaving:t}=w();return(0,l.jsx)(i.__experimentalVStack,{spacing:4,style:{maxWidth:620,opacity:t?.5:1,pointerEvents:t?"none":"auto",cursor:t?"wait":"auto"},children:Object.keys(e).map((t=>(0,l.jsx)(u.ErrorBoundary,{children:(0,l.jsx)(P,{settingKey:t,setting:e[t]})},t)))})},P=({setting:e,settingKey:t})=>{const{saved:n,setAttributes:s}=w();return"integration_panel"===e.el?(0,l.jsx)(y,{...e}):"settings_group"===e.el?(0,l.jsx)(S,{...e}):(0,l.jsx)(u.Setting,{settingKey:t,setting:e,saved:n,setAttributes:s})},C=(0,l.jsx)(N,{}),B=()=>(0,l.jsx)(u.ErrorBoundary,{children:(0,l.jsxs)(i.__experimentalNavigatorProvider,{initialPath:(0,h.getPath)(),children:[(0,l.jsx)(i.__experimentalNavigatorScreen,{path:"/",children:C}),(0,l.jsx)(i.__experimentalNavigatorScreen,{path:"/:tab",children:C}),(0,l.jsx)(i.__experimentalNavigatorScreen,{path:"/:tab/:section",children:C})]})}),E=()=>{const{save:e,isSaving:t}=w();return{variant:"primary",text:t?(0,_.__)("Saving...","newsletter-optin-box"):(0,_.__)("Save Settings","newsletter-optin-box"),onClick:e,isBusy:t,disabled:t}},A=e=>(0,l.jsx)(r.Header,{...e,actions:[E()]}),R=(0,l.jsxs)(i.__experimentalVStack,{children:[(0,l.jsx)(B,{}),(0,l.jsx)(p,{}),(0,l.jsx)(d,{})]}),T=()=>(0,l.jsx)(r.Footer,{children:(0,l.jsx)(i.Button,{...E()})});function M(e){return(0,l.jsx)(r.Interface,{className:"hizzlewp-settings__interface",header:(0,l.jsx)(A,{...e}),content:R,footer:(0,l.jsx)(T,{})})}const{option_name:L,saved:O,settings:V,...F}=window.hizzleWPSettings?.data||{};n()((()=>{const e=document.getElementById("hizzlewp-settings__app");if(!e||!V)return;const t=()=>(0,l.jsx)(i.SlotFillProvider,{children:(0,l.jsx)(b,{option_name:L||"hizzlewp_settings",settings:V||{},saved:O||{},children:(0,l.jsx)(M,{...F})})});(0,s.createRoot)(e).render((0,l.jsx)(t,{}))}))})();