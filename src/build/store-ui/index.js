(()=>{"use strict";var e,r={486:(e,r,n)=>{const t=window.wp.domReady;var s=n.n(t);const i=window.wp.element,a=window.wp.components,o=window.React,l=window.hizzlewp.interface,c=window.hizzlewp.components,d=window.wp.data,u=window.wp.notices,p=window.ReactJSXRuntime;function m(){const{notices:e}=(0,d.useSelect)((e=>({notices:e(u.store).getNotices()})),[]),{removeNotice:r}=(0,d.useDispatch)(u.store),n=e.filter((({isDismissible:e,type:r})=>e&&"default"===r)),t=e.filter((({isDismissible:e,type:r})=>!e&&"default"===r));return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.NoticeList,{notices:t,className:"components-editor-notices__pinned"}),(0,p.jsx)(a.NoticeList,{notices:n,className:"components-editor-notices__dismissible",onRemove:r})]})}function h(){const e=(0,d.useSelect)((e=>e(u.store).getNotices()),[]),{removeNotice:r}=(0,d.useDispatch)(u.store),n=e.filter((({type:e})=>"snackbar"===e)).slice(-3);return(0,p.jsx)(a.SnackbarList,{notices:n,className:"components-editor-notices__snackbar",onRemove:r})}const x=window.hizzlewp.history,g=window.hizzlewp.store,j=({children:e})=>(0,p.jsx)("div",{className:"hizzlewp-upsell-card",children:e}),f=({upsell:e})=>{if(!e)return null;const{content:r,buttonURL:n,buttonText:t}=e;return(0,p.jsx)(j,{children:(0,p.jsxs)(a.Tip,{children:[r,(0,p.jsx)(a.Button,{href:n,target:"_blank",variant:"link",children:t})]})})},y=()=>{const{config:e}=(0,g.useProvidedCollectionConfig)(),{path:r}=(0,x.useRoute)(),n=`/${e.namespace}/${e.collection}`,t=(0,o.useMemo)((()=>{const t=[];return e?(n===r?t.push({text:e.labels?.add_new_item||"Add New",onClick:()=>(0,x.updatePath)(`${n}/add`),variant:"primary"}):t.push({text:e.labels?.view_items||"View Items",onClick:()=>(0,x.updatePath)(n),variant:"primary"}),e.routes&&Object.entries(e.routes).forEach((([e,{title:r,...n}])=>{t.push({text:r,onClick:n.href?void 0:()=>(0,x.updatePath)(e),...n})})),t):t}),[e,r]);return(0,p.jsxs)(a.Card,{isRounded:!1,children:[(0,p.jsxs)(a.CardHeader,{as:a.__experimentalHStack,children:[(0,p.jsxs)(a.__experimentalHeading,{level:1,size:18,variant:"muted",children:[e.labels?.name||"Items",(0,p.jsx)(a.Slot,{name:`${n}/title`,children:e=>Array.isArray(e)&&e.length>0&&(0,p.jsxs)(c.ErrorBoundary,{children:[(0,p.jsx)(a.__experimentalText,{variant:"muted",children:"/"}),(0,p.jsx)(a.__experimentalText,{children:e})]})})]}),(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(a.__experimentalHStack,{expanded:!1,children:t.map((e=>(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(a.Button,{...e})},e.text)))})})]}),(0,p.jsx)(a.CardBody,{children:(0,p.jsxs)(a.__experimentalVStack,{children:[(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(x.Outlet,{path:"/:namespace/:collection"})}),(0,p.jsx)(a.Slot,{name:"noptin-interface-notices"}),e.fills&&e.fills.map((e=>(0,p.jsx)(a.Fill,{name:`${e.name}`,children:(0,p.jsxs)(c.ErrorBoundary,{children:[e.content&&(0,p.jsx)("span",{dangerouslySetInnerHTML:{__html:e.content}}),e.upsell&&(0,p.jsx)(f,{upsell:e.upsell})]})},e.name)))]})})]})},b=({children:e})=>{const{config:r,isResolving:n,hasResolved:t,error:s}=(0,g.useProvidedCollectionConfig)();return n||!t?(0,p.jsx)(a.Spinner,{}):s||!r?(0,p.jsx)(a.Notice,{status:"error",isDismissible:!1,children:s?.message||"An unknown error occurred."}):(0,p.jsx)(c.ErrorBoundary,{children:e})},_=({defaultNamespace:e,defaultCollection:r})=>{const{params:n}=(0,x.useRoute)(),t=n?.get("namespace")||e,s=n?.get("collection")||r,i=n?.get("id");return(0,p.jsx)(g.CollectionProvider,{namespace:t,collection:s,recordId:i,children:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(b,{children:(0,p.jsx)(y,{})})})})},w=window.hizzlewp.records,v=window.wp.date,C=window.wp.url,k=window.wp.i18n;function z(e){if(["subscribed","subscribe","active","yes","true","1","complete"].includes(e))return{backgroundColor:"#78c67a",color:"#111111"};if(["unsubscribed","unsubscribe","inactive","no","false","0","canceled"].includes(e))return{backgroundColor:"#fbcfbd",color:"#241c15"};if(["pending","waiting","maybe","2"].includes(e))return{backgroundColor:"#fbeeca",color:"#241c15"};const r=(0,c.stringToColor)(e,{saturation:[60,100],lightness:[30,45]});return{backgroundColor:r.color,color:r.isLight?"#111111":"#ffffff"}}const S=e=>{const{className:r,...n}=e;return(0,p.jsx)("span",{className:`hizzlewp-badge ${r||""}`,...n})},N=(e,r,n=!1)=>{if(!e)return e;n&&(e=(0,C.addQueryArgs)(e,{s:360}));const t=(0,C.getQueryArg)(e,"d");if(!t||!t.includes("ui-avatars.com"))return e;const s=t.match(/\/api\/(.*?)\/64\//),i=s&&s.length>1?s[1]:t,a=z(r||i),o=t.indexOf("/64/");return-1!==o&&(e=(0,C.addQueryArgs)(e,{d:`${t.substring(0,o+4)}/${a.backgroundColor.replace("#","")}/${a.color.replace("#","")}`})),e.includes("%2F64%2F%")&&(e=e.replace("%2F64%2F%","%2F360%2F%")),e},B=({record:e,name:r,viewType:n,path:t})=>{const s=e[r],o="table"!==n?"":N(e.avatar_url,s),l=o?(0,p.jsx)("img",{className:"hizzlewp-avatar",src:o,alt:s}):null,c=(0,i.useCallback)((()=>t?(0,x.updatePath)(t):null),[t]),d=(0,p.jsxs)(a.Flex,{className:"hizzlewp-table__cell--primary",children:[l&&(0,p.jsx)(a.FlexItem,{children:l}),(0,p.jsx)(a.FlexBlock,{children:s})]});return t?(0,p.jsx)(a.Button,{variant:"link",style:{width:"100%",alignItems:"start",textDecoration:"none"},onClick:c,children:d}):d},A=({value:e,enums:r={}})=>{const[n,t]=(0,i.useState)(!1),s=n?e:e.slice(0,2),o=e.length>2;return(0,p.jsxs)(a.Flex,{gap:2,justify:"flex-start",wrap:!0,children:[s.map((e=>(0,p.jsx)(a.FlexItem,{children:(0,p.jsx)(S,{style:z(e),children:r[e]||e})},e))),o&&(0,p.jsx)(a.FlexItem,{children:(0,p.jsx)(a.Button,{variant:"link",onClick:()=>t(!n),children:n?(0,k.__)("Hide","newsletter-optin-box"):(0,k.__)("Show all","newsletter-optin-box")})})]})},E=({row:e,header:r,viewType:n="table",isBadge:t=!1,path:s})=>{const i=e[r.name];if(null==i||""===i)return t?"":(0,p.jsx)("span",{className:"hizzlewp-table__cell--null",children:"–"});if(Array.isArray(i)&&0===i.length)return t?"":(0,p.jsx)("span",{className:"noptin-table__cell--null",children:"–"});if(r.is_primary&&"string"==typeof i)return(0,p.jsx)(B,{record:e,name:r.name,viewType:n,path:s});if("avatar_url"===r.name){const r=N(e.avatar_url,i,"table"!==n);return r?"table"!==n?(0,p.jsx)("img",{src:r,alt:i}):r?(0,p.jsx)("img",{className:"hizzlewp-avatar",src:r,alt:i}):null:null}if(r.is_boolean){const e=i?"yes":"no",r=i?"#3a9001":"#880000";return(0,p.jsx)(a.Icon,{size:24,style:{color:r},icon:e})}if(r.is_date&&i){const e=(0,v.getSettings)();return 10===i.length?(0,v.dateI18n)(e.formats.date,i):(0,v.dateI18n)(e.formats.datetime,i)}return r.is_tokens&&Array.isArray(i)?(0,p.jsx)(A,{value:i}):r.enum&&Array.isArray(i)?(0,p.jsx)(A,{value:i,enums:r.enum}):r.is_numeric||r.is_float||"string"==typeof i?r.enum&&(o=r.enum)&&"object"==typeof o&&o.constructor===Object?(0,p.jsx)(S,{style:z(i),children:r.enum?.[i]||i}):i:JSON.stringify(i);var o},O=()=>{const{config:{namespace:e,collection:r,props:n,ignore:t,hidden:s,badges:i}}=(0,g.useProvidedCollectionConfig)()||{},d=(0,x.useQuery)(),u=(0,g.useCollectionRecords)(e,r,d),{preferences:m,setPreferences:h}=(0,l.usePreferences)("recordsTablePreferences",`${e}/${r}`),{preferences:j}=(0,l.usePreferences)("view",`${e}/${r}`),f=(0,o.useMemo)((()=>{const s=[];return n.forEach((n=>{n.is_textarea&&!n.is_tokens&&(!n.enum||Array.isArray(n.enum))||t.includes(n.name)||"hide"===n.js_props?.table||s.push({accessorKey:n.name,header:n.label,enableSorting:!n.is_dynamic&&!n.is_meta,enableHiding:!n.is_primary,cell:({row:t})=>(0,p.jsx)(E,{row:t.original,header:n,isBadge:Array.isArray(i)&&i.includes(n.name),path:`${e}/${r}/${t.original.id}`})})})),s}),[n,t]),y=(0,o.useMemo)((()=>(Array.isArray(j?.hiddenFields)?j?.hiddenFields:s).reduce(((e,r)=>(e[r]=!1,e)),{})),[s,j]),b=(0,o.useMemo)((()=>{const e=d.orderby,r=d.order||"desc";return{columnVisibility:y,...m,sorting:e?[{id:e,desc:"desc"===r}]:m?.sorting||[],pagination:{pageSize:d.per_page||m?.pagination?.pageSize||25,pageIndex:d.paged?Number(d.paged)-1:0}}}),[u.records,d,m,h]),_=(0,o.useCallback)((e=>{h(e),(0,x.updateQueryString)({orderby:e?.sorting?.[0]?.id||"",order:e?.sorting?.[0]?.desc?"desc":"asc",per_page:`${e?.pagination?.pageSize||25}`,paged:`${(e?.pagination?.pageIndex||0)+1}`})}),[h]);return u.isResolving||!u.hasResolved?(0,p.jsx)("div",{className:"hizzlewp-records-table-loading",children:(0,p.jsx)(a.Spinner,{})}):"ERROR"===u.status?(0,p.jsx)(a.Notice,{status:"error",isDismissible:!1,children:u.error?.message||"An unknown error occurred."}):(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(w.Table,{rowCount:u.totalItems||0,data:u.records||[],columns:f,enableSorting:!0,enableFiltering:!0,enablePagination:!0,state:b,onChange:_})})},$=({record:e,onChange:r,schema:n,hidden:t,ignore:s,onSubmit:i,loading:l,slotName:d,submitText:u})=>{const m=(0,o.useMemo)((()=>((e,r,n)=>e.map((e=>e.readonly||e.is_dynamic||"metadata"===e.name||Array.isArray(r)&&r.includes(e.name)||Array.isArray(n)&&n.includes(e.name)?null:(e=>{const r={default:e.default,label:e.label,el:"input",type:"text",name:e.name,isInputToChange:!0};return e.js_props?.setting&&(r.customAttributes=e.js_props.setting),e.js_props?.conditions&&(r.conditions=e.js_props?.conditions),e.is_tokens?(r.el="form_token",r.suggestions=e.suggestions):e.enum&&!Array.isArray(e.enum)?(r.el="select",r.options=e.enum,e.multiple&&(r.el="multi_checkbox")):e.is_textarea&&(r.el="textarea"),(e.is_numeric||e.is_float)&&(r.type="number"),e.is_date&&(r.type="datetime-local",r.placeholder="YYYY-MM-DDTHH:MM:SS+ZZ:ZZ"),e.is_boolean&&(r.type="toggle"),e.description&&e.description!==e.label&&(r.description=e.description),r})(e))).filter((e=>!!e)))(n,t,s)),[n,t,s]);return(0,p.jsxs)(a.__experimentalVStack,{as:"form",spacing:4,style:{opacity:l?.5:1},onSubmit:i,children:[m.map((n=>(0,p.jsx)(c.Setting,{settingKey:n.name,saved:e,setAttributes:r,setting:n},n.name))),d&&(0,p.jsx)(a.Slot,{name:d,children:e=>Array.isArray(e)?e.map(((e,r)=>(0,p.jsx)(a.Tip,{children:e},r))):e}),(0,p.jsx)(a.Button,{className:"hizzlewp-block-button",variant:"primary",onClick:i,isBusy:l,__next40pxDefaultSize:!0,children:l?(0,p.jsx)(a.Spinner,{}):u})]})},T=()=>{const{config:{namespace:e,collection:r,props:n,hidden:t,ignore:s,defaultProps:i,labels:a}}=(0,g.useProvidedCollectionConfig)()||{},{saveCollectionRecord:l}=(0,d.useDispatch)(g.store),[c,m]=(0,o.useState)(!1),[h,j]=(0,o.useState)({}),f=[...s,...Object.keys(i||{})],{createErrorNotice:y,createSuccessNotice:b,removeAllNotices:_}=(0,d.useDispatch)(u.store),w=(0,o.useCallback)((n=>{n?.preventDefault(),c||(_(),m(!0),l(e,r,{...h,...i},{throwOnError:!0}).then((({id:n})=>{b((0,k.__)("Record saved successfully.","newsletter-optin-box"),{isDismissible:!0,type:"default"}),(0,x.updatePath)(`/${e}/${r}/${n}`)})).catch((e=>{y(e.message,{isDismissible:!0,type:"default"})})).finally((()=>{m(!1)})))}),[h,i,e,r,l,y,b,_]);return(0,p.jsx)($,{record:h,onChange:e=>j({...h,...e}),onSubmit:w,submitText:a?.save_item||(0,k.__)("Save","newsletter-optin-box"),schema:n,hidden:t,ignore:f,loading:c,slotName:`${e}_${r}_record_create_below`})},P=({children:e})=>(0,p.jsx)(a.FlexBlock,{children:(0,p.jsx)(c.ErrorBoundary,{children:e})}),R=()=>{const{config:{namespace:e,collection:r,labels:n}}=(0,g.useProvidedCollectionConfig)()||{};return(0,p.jsxs)(a.__experimentalHStack,{alignment:"flex-start",wrap:!0,children:[(0,p.jsx)(a.Fill,{name:`/${e}/${r}/title`,children:n?.add_new_item||"Add New Item"}),(0,p.jsx)(P,{children:(0,p.jsx)(T,{})}),(0,p.jsx)(a.Slot,{name:`${e}_${r}_record_create_upsell`,children:e=>e?(0,p.jsx)(P,{children:e}):null})]})},D=({defaultNamespace:e,defaultCollection:r})=>{const n=(0,o.useMemo)((()=>[{path:"/:namespace/:collection",element:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(_,{defaultNamespace:e,defaultCollection:r})}),index:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(O,{})}),children:[{path:"/:namespace/:collection/add",element:(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(R,{})})},{path:"/:namespace/:collection/import",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"})},{path:"/:namespace/:collection/export",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"})},{path:"/:namespace/:collection/:recordId",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"}),index:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"}),children:[{path:"/:namespace/:collection/:recordId/:tab",element:(0,p.jsx)(c.ErrorBoundary,{children:"TODO"})}]}]}]),[e,r]);return(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(x.Router,{basePath:`/${e}/${r}`,routes:n})})},F=e=>(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(l.Header,{...e})});function I({defaultNamespace:e,defaultCollection:r,...n}){const t=(0,o.useMemo)((()=>(0,p.jsxs)(a.__experimentalVStack,{style:{padding:20},children:[(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(D,{defaultNamespace:e,defaultCollection:r})}),(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(h,{})}),(0,p.jsx)(c.ErrorBoundary,{children:(0,p.jsx)(m,{})})]})),[e,r]);return(0,p.jsx)(l.Interface,{className:"hizzlewp-settings__interface",header:(0,p.jsx)(F,{...n}),content:t})}const{collection:M,namespace:H,...L}=window.hizzleWPStore?.data||{};s()((()=>{const e=document.getElementById("hizzlewp-store-ui");if(!e||!M||!H)return;const r=()=>(0,p.jsx)(a.SlotFillProvider,{children:(0,p.jsx)(I,{defaultNamespace:H,defaultCollection:M,...L})});(0,i.createRoot)(e).render((0,p.jsx)(r,{}))}))}},n={};function t(e){var s=n[e];if(void 0!==s)return s.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,t),i.exports}t.m=r,e=[],t.O=(r,n,s,i)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,s,i]=e[d],o=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(t.O).every((e=>t.O[e](n[l])))?n.splice(l--,1):(o=!1,i<a&&(a=i));if(o){e.splice(d--,1);var c=s();void 0!==c&&(r=c)}}return r}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,s,i]},t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),(()=>{var e={77:0,385:0};t.O.j=r=>0===e[r];var r=(r,n)=>{var s,i,[a,o,l]=n,c=0;if(a.some((r=>0!==e[r]))){for(s in o)t.o(o,s)&&(t.m[s]=o[s]);if(l)var d=l(t)}for(r&&r(n);c<a.length;c++)i=a[c],t.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return t.O(d)},n=globalThis.webpackChunkhizzlewp=globalThis.webpackChunkhizzlewp||[];n.forEach(r.bind(null,0)),n.push=r.bind(null,n.push.bind(n))})();var s=t.O(void 0,[385],(()=>t(486)));s=t.O(s)})();